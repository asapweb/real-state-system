<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\IndexType;
use App\Models\IndexValue;
use Carbon\Carbon;

class CreebbaIndexSeeder extends Seeder
{
    public function run(): void
    {
        // Obtener o crear el tipo de índice CREEBBA
        $indexType = IndexType::firstOrCreate([
            'code' => 'CREEBBA'
        ], [
            'name' => 'IPC CREEBBA',
            'calculation_mode' => 'percentage', // o 'ratio' si usás valores relativos
        ]);

        $values = [
            ['2021-01', 104.20], ['2021-02', 107.22], ['2021-03', 111.08],
            ['2021-04', 116.86], ['2021-05', 120.62], ['2021-06', 125.43],
            ['2021-07', 128.96], ['2021-08', 132.78], ['2021-09', 136.28],
            ['2021-10', 139.55], ['2021-11', 143.18], ['2021-12', 148.11],
            ['2022-01', 153.04], ['2022-02', 161.11], ['2022-03', 169.65],
            ['2022-04', 176.26], ['2022-05', 186.49], ['2022-06', 196.37],
            ['2022-07', 208.55], ['2022-08', 219.60], ['2022-09', 236.07],
            ['2022-10', 251.86], ['2022-11', 262.45], ['2022-12', 275.08],
            ['2023-01', 292.98], ['2023-02', 311.09], ['2023-03', 336.26],
            ['2023-04', 363.65], ['2023-05', 388.25], ['2023-06', 412.19],
            ['2023-07', 437.27], ['2023-08', 482.52], ['2023-09', 538.08],
            ['2023-10', 581.90], ['2023-11', 649.49], ['2023-12', 819.01],
            ['2024-01', 1005.15], ['2024-02', 1151.37], ['2024-03', 1306.32],
            ['2024-04', 1422.97], ['2024-05', 1507.52], ['2024-06', 1576.00],
            ['2024-07', 1641.58], ['2024-08', 1713.70], ['2024-09', 1767.62],
            ['2024-10', 1809.62], ['2024-11', 1859.22], ['2024-12', 1907.62],
            ['2025-01', 1950.69], ['2025-02', 1997.01], ['2025-03', 2055.77],
            ['2025-04', 2106.51], ['2025-05', 2139.52], ['2025-06', 2187.66],
        ];

        foreach ($values as [$ym, $value]) {
            $effectiveDate = Carbon::createFromFormat('Y-m', $ym)->startOfMonth();

            IndexValue::updateOrCreate([
                'index_type_id' => $indexType->id,
                'effective_date' => $effectiveDate,
            ], [
                'value' => $value,
            ]);
        }
    }
}
